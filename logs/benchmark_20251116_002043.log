[2025-11-16 00:20:43] INFO: ================================================================================
[2025-11-16 00:20:43] INFO: Starting Strategy Benchmark Test
[2025-11-16 00:20:43] INFO: ================================================================================
[2025-11-16 00:20:43] INFO: Log file: logs\benchmark_20251116_002043.log
[2025-11-16 00:20:43] INFO: CSV file: results\benchmark_results_20251116_002043.csv
[2025-11-16 00:20:43] INFO: 
[2025-11-16 00:20:43] INFO: Configuration:
[2025-11-16 00:20:43] INFO:   Hardware: 8 channels, 4.0 TOPS compute
[2025-11-16 00:20:43] INFO:   Inference: past_seq_len=1024, data_format=FP16
[2025-11-16 00:20:43] INFO:   Strategies: ['h2llm', 'recursive_grid_search']
[2025-11-16 00:20:43] INFO:   Models: ['Meta-Llama-3-8B', 'Qwen3-4B', 'Qwen3-8B']
[2025-11-16 00:20:43] INFO:   Batch sizes: [16, 32, 64]
[2025-11-16 00:20:43] INFO: 
[2025-11-16 00:20:43] INFO: ================================================================================
[2025-11-16 00:20:43] INFO: Testing model: Meta-Llama-3-8B
[2025-11-16 00:20:43] INFO: ================================================================================
[2025-11-16 00:20:43] INFO: 
Batch size: 16
[2025-11-16 00:20:43] INFO: --------------------------------------------------------------------------------
[2025-11-16 00:20:43] INFO: Building base computation graph for Meta-Llama-3-8B, batch_size=16
[2025-11-16 00:20:43] INFO:   Model config: hidden_size=4096, intermediate_size=14336, num_attention_heads=32
[2025-11-16 00:20:44] INFO:   Tracing module with input shape: torch.Size([16, 1, 4096])
[2025-11-16 00:20:45] INFO:   Initial graph: 31 nodes
[2025-11-16 00:20:45] INFO:   Running NormalizeOpsPass...
[2025-11-16 00:20:45] INFO:     After normalization: 31 nodes
[2025-11-16 00:20:45] INFO:   Running SimplifyGraphPass...
[2025-11-16 00:20:45] INFO:     After simplification: 18 nodes
[2025-11-16 00:20:45] INFO: 
[Test 1/18] Strategy: h2llm
[2025-11-16 00:20:45] INFO:   Running passes for strategy: h2llm
[2025-11-16 00:20:45] INFO:     Running MatrixMappingPass with strategy=h2llm...
[2025-11-16 00:20:45] INFO:     Running VectorLatencyPass...
[2025-11-16 00:20:45] INFO:     Running LatencyCalculationPass...
[2025-11-16 00:20:45] INFO:     Total latency: 307695.000000 seconds
[2025-11-16 00:20:45] INFO:     Matrix ops: 9, Vector ops: 5
[2025-11-16 00:20:45] INFO:   ✓ Test completed successfully
[2025-11-16 00:20:45] INFO: 
[Test 2/18] Strategy: recursive_grid_search
[2025-11-16 00:20:45] INFO:   Running passes for strategy: recursive_grid_search
[2025-11-16 00:20:45] INFO:     Running MatrixFusionPass...
[2025-11-16 00:20:45] INFO:       After fusion: 15 nodes
[2025-11-16 00:20:45] INFO:     Running MatrixMappingPass with strategy=recursive_grid_search...
[2025-11-16 00:21:06] INFO:     Running LatencyCalculationPass...
[2025-11-16 00:21:06] INFO:     Total latency: 209664.000000 seconds
[2025-11-16 00:21:06] INFO:     Matrix ops: 6, Vector ops: 0
[2025-11-16 00:21:06] INFO:   ✓ Test completed successfully
[2025-11-16 00:21:06] INFO: 
Batch size: 32
[2025-11-16 00:21:06] INFO: --------------------------------------------------------------------------------
[2025-11-16 00:21:06] INFO: Building base computation graph for Meta-Llama-3-8B, batch_size=32
[2025-11-16 00:21:06] INFO:   Model config: hidden_size=4096, intermediate_size=14336, num_attention_heads=32
[2025-11-16 00:21:07] INFO:   Tracing module with input shape: torch.Size([32, 1, 4096])
[2025-11-16 00:21:07] INFO:   Initial graph: 31 nodes
[2025-11-16 00:21:07] INFO:   Running NormalizeOpsPass...
[2025-11-16 00:21:07] INFO:     After normalization: 31 nodes
[2025-11-16 00:21:07] INFO:   Running SimplifyGraphPass...
[2025-11-16 00:21:07] INFO:     After simplification: 18 nodes
[2025-11-16 00:21:07] INFO: 
[Test 3/18] Strategy: h2llm
[2025-11-16 00:21:07] INFO:   Running passes for strategy: h2llm
[2025-11-16 00:21:07] INFO:     Running MatrixMappingPass with strategy=h2llm...
[2025-11-16 00:21:08] INFO:     Running VectorLatencyPass...
[2025-11-16 00:21:08] INFO:     Running LatencyCalculationPass...
[2025-11-16 00:21:08] INFO:     Total latency: 554571.000000 seconds
[2025-11-16 00:21:08] INFO:     Matrix ops: 9, Vector ops: 5
[2025-11-16 00:21:08] INFO:   ✓ Test completed successfully
[2025-11-16 00:21:08] INFO: 
[Test 4/18] Strategy: recursive_grid_search
[2025-11-16 00:21:08] INFO:   Running passes for strategy: recursive_grid_search
[2025-11-16 00:21:08] INFO:     Running MatrixFusionPass...
[2025-11-16 00:21:08] INFO:       After fusion: 15 nodes
[2025-11-16 00:21:08] INFO:     Running MatrixMappingPass with strategy=recursive_grid_search...
[2025-11-16 00:21:32] INFO:     Running LatencyCalculationPass...
[2025-11-16 00:21:32] INFO:     Total latency: 358970.000000 seconds
[2025-11-16 00:21:32] INFO:     Matrix ops: 6, Vector ops: 0
[2025-11-16 00:21:32] INFO:   ✓ Test completed successfully
[2025-11-16 00:21:32] INFO: 
Batch size: 64
[2025-11-16 00:21:32] INFO: --------------------------------------------------------------------------------
[2025-11-16 00:21:32] INFO: Building base computation graph for Meta-Llama-3-8B, batch_size=64
[2025-11-16 00:21:32] INFO:   Model config: hidden_size=4096, intermediate_size=14336, num_attention_heads=32
[2025-11-16 00:21:33] INFO:   Tracing module with input shape: torch.Size([64, 1, 4096])
[2025-11-16 00:21:34] INFO:   Initial graph: 31 nodes
[2025-11-16 00:21:34] INFO:   Running NormalizeOpsPass...
[2025-11-16 00:21:34] INFO:     After normalization: 31 nodes
[2025-11-16 00:21:34] INFO:   Running SimplifyGraphPass...
[2025-11-16 00:21:34] INFO:     After simplification: 18 nodes
[2025-11-16 00:21:34] INFO: 
[Test 5/18] Strategy: h2llm
[2025-11-16 00:21:34] INFO:   Running passes for strategy: h2llm
[2025-11-16 00:21:34] INFO:     Running MatrixMappingPass with strategy=h2llm...
[2025-11-16 00:21:34] INFO:     Running VectorLatencyPass...
[2025-11-16 00:21:34] INFO:     Running LatencyCalculationPass...
[2025-11-16 00:21:34] INFO:     Total latency: 1109135.000000 seconds
[2025-11-16 00:21:34] INFO:     Matrix ops: 9, Vector ops: 5
[2025-11-16 00:21:34] INFO:   ✓ Test completed successfully
[2025-11-16 00:21:34] INFO: 
[Test 6/18] Strategy: recursive_grid_search
[2025-11-16 00:21:34] INFO:   Running passes for strategy: recursive_grid_search
[2025-11-16 00:21:34] INFO:     Running MatrixFusionPass...
[2025-11-16 00:21:34] INFO:       After fusion: 15 nodes
[2025-11-16 00:21:34] INFO:     Running MatrixMappingPass with strategy=recursive_grid_search...
[2025-11-16 00:21:55] INFO:     Running LatencyCalculationPass...
[2025-11-16 00:21:55] INFO:     Total latency: 717942.000000 seconds
[2025-11-16 00:21:55] INFO:     Matrix ops: 6, Vector ops: 0
[2025-11-16 00:21:55] INFO:   ✓ Test completed successfully
[2025-11-16 00:21:55] INFO: ================================================================================
[2025-11-16 00:21:55] INFO: Testing model: Qwen3-4B
[2025-11-16 00:21:55] INFO: ================================================================================
[2025-11-16 00:21:55] INFO: 
Batch size: 16
[2025-11-16 00:21:55] INFO: --------------------------------------------------------------------------------
[2025-11-16 00:21:55] INFO: Building base computation graph for Qwen3-4B, batch_size=16
[2025-11-16 00:21:55] INFO:   Model config: hidden_size=2560, intermediate_size=9728, num_attention_heads=32
[2025-11-16 00:21:55] INFO:   Tracing module with input shape: torch.Size([16, 1, 2560])
[2025-11-16 00:21:55] INFO:   Initial graph: 31 nodes
[2025-11-16 00:21:55] INFO:   Running NormalizeOpsPass...
[2025-11-16 00:21:55] INFO:     After normalization: 31 nodes
[2025-11-16 00:21:55] INFO:   Running SimplifyGraphPass...
[2025-11-16 00:21:55] INFO:     After simplification: 18 nodes
[2025-11-16 00:21:55] INFO: 
[Test 7/18] Strategy: h2llm
[2025-11-16 00:21:55] INFO:   Running passes for strategy: h2llm
[2025-11-16 00:21:55] INFO:     Running MatrixMappingPass with strategy=h2llm...
[2025-11-16 00:21:56] INFO:     Running VectorLatencyPass...
[2025-11-16 00:21:56] INFO:     Running LatencyCalculationPass...
[2025-11-16 00:21:56] INFO:     Total latency: 179499.000000 seconds
[2025-11-16 00:21:56] INFO:     Matrix ops: 9, Vector ops: 5
[2025-11-16 00:21:56] INFO:   ✓ Test completed successfully
[2025-11-16 00:21:56] INFO: 
[Test 8/18] Strategy: recursive_grid_search
[2025-11-16 00:21:56] INFO:   Running passes for strategy: recursive_grid_search
[2025-11-16 00:21:56] INFO:     Running MatrixFusionPass...
[2025-11-16 00:21:56] INFO:       After fusion: 15 nodes
[2025-11-16 00:21:56] INFO:     Running MatrixMappingPass with strategy=recursive_grid_search...
[2025-11-16 00:22:15] INFO:     Running LatencyCalculationPass...
[2025-11-16 00:22:15] INFO:     Total latency: 110049.000000 seconds
[2025-11-16 00:22:15] INFO:     Matrix ops: 6, Vector ops: 0
[2025-11-16 00:22:15] INFO:   ✓ Test completed successfully
[2025-11-16 00:22:15] INFO: 
Batch size: 32
[2025-11-16 00:22:15] INFO: --------------------------------------------------------------------------------
[2025-11-16 00:22:15] INFO: Building base computation graph for Qwen3-4B, batch_size=32
[2025-11-16 00:22:15] INFO:   Model config: hidden_size=2560, intermediate_size=9728, num_attention_heads=32
[2025-11-16 00:22:16] INFO:   Tracing module with input shape: torch.Size([32, 1, 2560])
[2025-11-16 00:22:16] INFO:   Initial graph: 31 nodes
[2025-11-16 00:22:16] INFO:   Running NormalizeOpsPass...
[2025-11-16 00:22:16] INFO:     After normalization: 31 nodes
[2025-11-16 00:22:16] INFO:   Running SimplifyGraphPass...
[2025-11-16 00:22:16] INFO:     After simplification: 18 nodes
[2025-11-16 00:22:16] INFO: 
[Test 9/18] Strategy: h2llm
[2025-11-16 00:22:16] INFO:   Running passes for strategy: h2llm
[2025-11-16 00:22:16] INFO:     Running MatrixMappingPass with strategy=h2llm...
[2025-11-16 00:22:16] INFO:     Running VectorLatencyPass...
[2025-11-16 00:22:16] INFO:     Running LatencyCalculationPass...
[2025-11-16 00:22:16] INFO:     Total latency: 333760.000000 seconds
[2025-11-16 00:22:16] INFO:     Matrix ops: 9, Vector ops: 5
[2025-11-16 00:22:16] INFO:   ✓ Test completed successfully
[2025-11-16 00:22:16] INFO: 
[Test 10/18] Strategy: recursive_grid_search
[2025-11-16 00:22:16] INFO:   Running passes for strategy: recursive_grid_search
[2025-11-16 00:22:16] INFO:     Running MatrixFusionPass...
[2025-11-16 00:22:16] INFO:       After fusion: 15 nodes
[2025-11-16 00:22:16] INFO:     Running MatrixMappingPass with strategy=recursive_grid_search...
[2025-11-16 00:22:36] INFO:     Running LatencyCalculationPass...
[2025-11-16 00:22:36] INFO:     Total latency: 197833.000000 seconds
[2025-11-16 00:22:36] INFO:     Matrix ops: 6, Vector ops: 0
[2025-11-16 00:22:36] INFO:   ✓ Test completed successfully
[2025-11-16 00:22:36] INFO: 
Batch size: 64
[2025-11-16 00:22:36] INFO: --------------------------------------------------------------------------------
[2025-11-16 00:22:36] INFO: Building base computation graph for Qwen3-4B, batch_size=64
[2025-11-16 00:22:36] INFO:   Model config: hidden_size=2560, intermediate_size=9728, num_attention_heads=32
[2025-11-16 00:22:36] INFO:   Tracing module with input shape: torch.Size([64, 1, 2560])
[2025-11-16 00:22:37] INFO:   Initial graph: 31 nodes
[2025-11-16 00:22:37] INFO:   Running NormalizeOpsPass...
[2025-11-16 00:22:37] INFO:     After normalization: 31 nodes
[2025-11-16 00:22:37] INFO:   Running SimplifyGraphPass...
[2025-11-16 00:22:37] INFO:     After simplification: 18 nodes
[2025-11-16 00:22:37] INFO: 
[Test 11/18] Strategy: h2llm
[2025-11-16 00:22:37] INFO:   Running passes for strategy: h2llm
[2025-11-16 00:22:37] INFO:     Running MatrixMappingPass with strategy=h2llm...
[2025-11-16 00:22:37] INFO:     Running VectorLatencyPass...
[2025-11-16 00:22:37] INFO:     Running LatencyCalculationPass...
[2025-11-16 00:22:37] INFO:     Total latency: 667520.000000 seconds
[2025-11-16 00:22:37] INFO:     Matrix ops: 9, Vector ops: 5
[2025-11-16 00:22:37] INFO:   ✓ Test completed successfully
[2025-11-16 00:22:37] INFO: 
[Test 12/18] Strategy: recursive_grid_search
[2025-11-16 00:22:37] INFO:   Running passes for strategy: recursive_grid_search
[2025-11-16 00:22:37] INFO:     Running MatrixFusionPass...
[2025-11-16 00:22:37] INFO:       After fusion: 15 nodes
[2025-11-16 00:22:37] INFO:     Running MatrixMappingPass with strategy=recursive_grid_search...
[2025-11-16 00:22:56] INFO:     Running LatencyCalculationPass...
[2025-11-16 00:22:56] INFO:     Total latency: 395668.000000 seconds
[2025-11-16 00:22:56] INFO:     Matrix ops: 6, Vector ops: 0
[2025-11-16 00:22:56] INFO:   ✓ Test completed successfully
[2025-11-16 00:22:56] INFO: ================================================================================
[2025-11-16 00:22:56] INFO: Testing model: Qwen3-8B
[2025-11-16 00:22:56] INFO: ================================================================================
[2025-11-16 00:22:56] INFO: 
Batch size: 16
[2025-11-16 00:22:56] INFO: --------------------------------------------------------------------------------
[2025-11-16 00:22:56] INFO: Building base computation graph for Qwen3-8B, batch_size=16
[2025-11-16 00:22:56] INFO:   Model config: hidden_size=4096, intermediate_size=12288, num_attention_heads=32
[2025-11-16 00:22:57] INFO:   Tracing module with input shape: torch.Size([16, 1, 4096])
[2025-11-16 00:22:57] INFO:   Initial graph: 31 nodes
[2025-11-16 00:22:57] INFO:   Running NormalizeOpsPass...
[2025-11-16 00:22:57] INFO:     After normalization: 31 nodes
[2025-11-16 00:22:57] INFO:   Running SimplifyGraphPass...
[2025-11-16 00:22:57] INFO:     After simplification: 18 nodes
[2025-11-16 00:22:57] INFO: 
[Test 13/18] Strategy: h2llm
[2025-11-16 00:22:57] INFO:   Running passes for strategy: h2llm
[2025-11-16 00:22:57] INFO:     Running MatrixMappingPass with strategy=h2llm...
[2025-11-16 00:22:57] INFO:     Running VectorLatencyPass...
[2025-11-16 00:22:57] INFO:     Running LatencyCalculationPass...
[2025-11-16 00:22:57] INFO:     Total latency: 286846.000000 seconds
[2025-11-16 00:22:57] INFO:     Matrix ops: 9, Vector ops: 5
[2025-11-16 00:22:57] INFO:   ✓ Test completed successfully
[2025-11-16 00:22:57] INFO: 
[Test 14/18] Strategy: recursive_grid_search
[2025-11-16 00:22:57] INFO:   Running passes for strategy: recursive_grid_search
[2025-11-16 00:22:57] INFO:     Running MatrixFusionPass...
[2025-11-16 00:22:57] INFO:       After fusion: 15 nodes
[2025-11-16 00:22:57] INFO:     Running MatrixMappingPass with strategy=recursive_grid_search...
[2025-11-16 00:23:18] INFO:     Running LatencyCalculationPass...
[2025-11-16 00:23:18] INFO:     Total latency: 192310.000000 seconds
[2025-11-16 00:23:18] INFO:     Matrix ops: 6, Vector ops: 0
[2025-11-16 00:23:18] INFO:   ✓ Test completed successfully
[2025-11-16 00:23:18] INFO: 
Batch size: 32
[2025-11-16 00:23:18] INFO: --------------------------------------------------------------------------------
[2025-11-16 00:23:18] INFO: Building base computation graph for Qwen3-8B, batch_size=32
[2025-11-16 00:23:18] INFO:   Model config: hidden_size=4096, intermediate_size=12288, num_attention_heads=32
[2025-11-16 00:23:19] INFO:   Tracing module with input shape: torch.Size([32, 1, 4096])
[2025-11-16 00:23:19] INFO:   Initial graph: 31 nodes
[2025-11-16 00:23:19] INFO:   Running NormalizeOpsPass...
[2025-11-16 00:23:19] INFO:     After normalization: 31 nodes
[2025-11-16 00:23:19] INFO:   Running SimplifyGraphPass...
[2025-11-16 00:23:19] INFO:     After simplification: 18 nodes
[2025-11-16 00:23:19] INFO: 
[Test 15/18] Strategy: h2llm
[2025-11-16 00:23:19] INFO:   Running passes for strategy: h2llm
[2025-11-16 00:23:19] INFO:     Running MatrixMappingPass with strategy=h2llm...
[2025-11-16 00:23:19] INFO:     Running VectorLatencyPass...
[2025-11-16 00:23:19] INFO:     Running LatencyCalculationPass...
[2025-11-16 00:23:19] INFO:     Total latency: 519164.000000 seconds
[2025-11-16 00:23:19] INFO:     Matrix ops: 9, Vector ops: 5
[2025-11-16 00:23:19] INFO:   ✓ Test completed successfully
[2025-11-16 00:23:19] INFO: 
[Test 16/18] Strategy: recursive_grid_search
[2025-11-16 00:23:19] INFO:   Running passes for strategy: recursive_grid_search
[2025-11-16 00:23:19] INFO:     Running MatrixFusionPass...
[2025-11-16 00:23:19] INFO:       After fusion: 15 nodes
[2025-11-16 00:23:19] INFO:     Running MatrixMappingPass with strategy=recursive_grid_search...
[2025-11-16 00:23:39] INFO:     Running LatencyCalculationPass...
[2025-11-16 00:23:39] INFO:     Total latency: 330729.000000 seconds
[2025-11-16 00:23:39] INFO:     Matrix ops: 6, Vector ops: 0
[2025-11-16 00:23:39] INFO:   ✓ Test completed successfully
[2025-11-16 00:23:39] INFO: 
Batch size: 64
[2025-11-16 00:23:39] INFO: --------------------------------------------------------------------------------
[2025-11-16 00:23:39] INFO: Building base computation graph for Qwen3-8B, batch_size=64
[2025-11-16 00:23:39] INFO:   Model config: hidden_size=4096, intermediate_size=12288, num_attention_heads=32
[2025-11-16 00:23:40] INFO:   Tracing module with input shape: torch.Size([64, 1, 4096])
[2025-11-16 00:23:40] INFO:   Initial graph: 31 nodes
[2025-11-16 00:23:40] INFO:   Running NormalizeOpsPass...
[2025-11-16 00:23:40] INFO:     After normalization: 31 nodes
[2025-11-16 00:23:40] INFO:   Running SimplifyGraphPass...
[2025-11-16 00:23:40] INFO:     After simplification: 18 nodes
[2025-11-16 00:23:40] INFO: 
[Test 17/18] Strategy: h2llm
[2025-11-16 00:23:40] INFO:   Running passes for strategy: h2llm
[2025-11-16 00:23:40] INFO:     Running MatrixMappingPass with strategy=h2llm...
[2025-11-16 00:23:41] INFO:     Running VectorLatencyPass...
[2025-11-16 00:23:41] INFO:     Running LatencyCalculationPass...
[2025-11-16 00:23:41] INFO:     Total latency: 1038324.000000 seconds
[2025-11-16 00:23:41] INFO:     Matrix ops: 9, Vector ops: 5
[2025-11-16 00:23:41] INFO:   ✓ Test completed successfully
[2025-11-16 00:23:41] INFO: 
[Test 18/18] Strategy: recursive_grid_search
[2025-11-16 00:23:41] INFO:   Running passes for strategy: recursive_grid_search
[2025-11-16 00:23:41] INFO:     Running MatrixFusionPass...
[2025-11-16 00:23:41] INFO:       After fusion: 15 nodes
[2025-11-16 00:23:41] INFO:     Running MatrixMappingPass with strategy=recursive_grid_search...
[2025-11-16 00:24:01] INFO:     Running LatencyCalculationPass...
[2025-11-16 00:24:01] INFO:     Total latency: 661469.000000 seconds
[2025-11-16 00:24:01] INFO:     Matrix ops: 6, Vector ops: 0
[2025-11-16 00:24:01] INFO:   ✓ Test completed successfully
[2025-11-16 00:24:01] INFO: 
[2025-11-16 00:24:01] INFO: ================================================================================
[2025-11-16 00:24:01] INFO: Benchmark Test Completed
[2025-11-16 00:24:01] INFO: ================================================================================
[2025-11-16 00:24:01] INFO: Total tests: 18
[2025-11-16 00:24:01] INFO: Successful tests: 18
[2025-11-16 00:24:01] INFO: Failed tests: 0
[2025-11-16 00:24:01] INFO: Results saved to: results\benchmark_results_20251116_002043.csv
[2025-11-16 00:24:01] INFO: Log saved to: logs\benchmark_20251116_002043.log
[2025-11-16 00:24:01] INFO: 
